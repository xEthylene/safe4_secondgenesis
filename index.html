<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>SAFE4: Second Genesis</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- 1. Add Babel Standalone for in-browser JSX/TS transpilation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script type="importmap">
{
  "imports": {
    "react/": "https://aistudiocdn.com/react@^19.1.1/",
    "react": "https://aistudiocdn.com/react@^19.1.1",
    "@google/genai": "https://aistudiocdn.com/@google/genai@^1.15.0",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.1.1/",
    "@heroicons/react/": "https://aistudiocdn.com/@heroicons/react@^2.2.0/",
    "https://esm.sh/immer": "https://aistudiocdn.com/immer@^10.1.1",
    "immer": "https://aistudiocdn.com/immer@^10.1.1"
  }
}
</script>
<style>
  :root {
    --color-bg: #111827; /* gray-900 */
    --color-text: #f3f4f6; /* gray-100 */
    --color-primary: #3b82f6; /* blue-500 */
    --color-primary-dark: #1e40af; /* blue-800 */
    --color-primary-light: #60a5fa; /* blue-400 */
    --color-secondary: #ef4444; /* red-500 */
    --color-secondary-dark: #b91c1c; /* red-700 */
  }
  body {
    background-color: var(--color-bg);
    color: var(--color-text);
  }
  .app-container {
    box-shadow: 0 0 25px 5px rgba(59, 130, 246, 0.15);
    border-color: rgba(59, 130, 246, 0.2);
  }
  .text-primary { color: var(--color-primary-light); }
  .bg-primary { background-color: var(--color-primary); }
  .hover\:bg-primary-light:hover { background-color: var(--color-primary-light); }
  .border-primary { border-color: var(--color-primary); }
  .bg-secondary { background-color: var(--color-secondary); }
  .hover\:bg-secondary-dark:hover { background-color: var(--color-secondary-dark); }
  .border-secondary { border-color: var(--color-secondary); }
  
  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
  .animate-fadeIn { animation: fadeIn 0.5s ease-in-out; }
  @keyframes dissolve { 0% { opacity: 1; filter: blur(0); } 100% { opacity: 0; filter: blur(10px); transform: scale(0.9); } }
  .animate-dissolve { animation: dissolve 0.7s forwards; }
  @keyframes float-up {
    0% { transform: translateY(0) scale(0.8); opacity: 1; }
    30% { transform: translateY(-20px) scale(1.1); opacity: 1; }
    100% { transform: translateY(-50px) scale(0.9); opacity: 0; }
  }
  .animate-float-up { animation: float-up 1.2s forwards ease-out; }
  @keyframes enemy-card-reveal {
    0% { opacity: 0; transform: scale(0.5) translateY(50px); }
    100% { opacity: 1; transform: scale(0.8) translateY(-20px); }
  }
  .animate-enemy-card-reveal { animation: enemy-card-reveal 0.5s forwards ease-in-out; }
  @keyframes enemy-play-card {
    0% { transform: scale(0.9) translateY(-20px) rotate(-3deg); opacity: 1; }
    50% { transform: scale(1.15) translateY(-90px) rotate(0deg); opacity: 1; }
    100% { transform: scale(0.6) translateY(0px) rotate(3deg); opacity: 0; }
  }
  .animate-enemy-play-card {
    animation: enemy-play-card 1.2s ease-in-out forwards;
  }
  
  @keyframes player-play-card {
    0% { transform: translateY(0) scale(1) rotate(0deg); opacity: 1; }
    50% { transform: translateY(-250px) scale(1.1) rotate(-2deg); opacity: 1; }
    100% { transform: translateY(-200px) scale(0.5) rotate(5deg); opacity: 0; }
  }
  .animate-player-play-card {
    animation: player-play-card 1s ease-in-out forwards;
  }

  /* Card Reveal Animation */
  .card-reveal-container {
    perspective: 1000px;
  }
  .card-flipper {
    position: relative;
    width: 100%;
    height: 100%;
    transition: transform 0.6s;
    transform-style: preserve-3d;
  }
  .card-flipper.is-flipped {
    transform: rotateY(180deg);
  }
  .card-face {
    position: absolute;
    width: 100%;
    height: 100%;
    -webkit-backface-visibility: hidden; /* Safari */
    backface-visibility: hidden;
    border-radius: 0.5rem; /* 8px */
  }
  .card-back {
    transform: rotateY(180deg);
  }
  @keyframes enemy-attack {
    50% { transform: translateY(-15px) scale(1.05); }
  }
  .animate-enemy-attack {
    animation: enemy-attack 0.6s ease-in-out;
  }
  
  /* Combat VFX */
  @keyframes hit-flash-red { 0%, 100% { filter: brightness(1) drop-shadow(0 0 0 transparent); } 50% { filter: brightness(2.5) drop-shadow(0 0 15px red); } }
  .animate-hit_hp { animation: hit-flash-red 0.3s ease-out; }

  @keyframes shield-impact { 0%, 100% { box-shadow: 0 0 0 0 transparent; } 50% { box-shadow: 0 0 25px 12px rgba(59, 130, 246, 0.7); } }
  .animate-hit_block { animation: shield-impact 0.4s ease-out; }
  
  @keyframes burn-pulse { 0%, 100% { filter: drop-shadow(0 0 0 transparent); transform: scale(1); } 50% { filter: brightness(1.5) drop-shadow(0 0 15px orange); transform: scale(1.2); } }
  .animate-burn { animation: burn-pulse 0.5s ease-in-out; }
  
  @keyframes bleed-pulse { 0%, 100% { filter: drop-shadow(0 0 0 transparent); transform: scale(1); } 50% { filter: brightness(1.5) drop-shadow(0 0 15px darkred); transform: scale(1.2); } }
  .animate-bleed { animation: bleed-pulse 0.5s ease-in-out; }

  @keyframes screen-shake {
    0% { transform: translate(0, 0) rotate(0deg); }
    10% { transform: translate(-2px, -3px) rotate(-1deg); }
    20% { transform: translate(-4px, 1px) rotate(1deg); }
    30% { transform: translate(4px, 3px) rotate(0deg); }
    40% { transform: translate(2px, -2px) rotate(1deg); }
    50% { transform: translate(-2px, 3px) rotate(-1deg); }
    60% { transform: translate(-4px, 2px) rotate(0deg); }
    70% { transform: translate(4px, 2px) rotate(-1deg); }
    80% { transform: translate(-2px, -2px) rotate(1deg); }
    90% { transform: translate(2px, 3px) rotate(0deg); }
    100% { transform: translate(0, 0) rotate(0deg); }
  }
  .animate-screen-shake { animation: screen-shake 0.3s cubic-bezier(.36,.07,.19,.97) both; }
  
  @keyframes turn-banner-slide {
    0% { transform: translateX(-100%); opacity: 0; }
    20% { transform: translateX(0); opacity: 1; }
    80% { transform: translateX(0); opacity: 1; }
    100% { transform: translateX(100%); opacity: 0; }
  }
  .animate-turn-banner { animation: turn-banner-slide 1.5s ease-in-out forwards; }

</style>
</head>
  <body>
    <div id="root"></div>
    <!-- 2. Change script type to text/babel for in-browser transpilation -->
    <script type="text/babel" data-type="module" src="/index.tsx"></script>
  </body>
</html>